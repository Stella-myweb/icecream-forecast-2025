<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아이스크림 판매량 예측 모델링</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism-tomorrow.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .slide-container {
            width: 1280px;
            min-height: 720px;
            background-color: #ffffff;
            position: relative;
            overflow: hidden;
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .header-accent {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 12px;
            background-color: #3498db;
            border-radius: 10px 10px 0 0;
        }
        .content {
            padding: 80px 100px;
            height: calc(100% - 12px);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .title {
            font-size: 52px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .subtitle {
            font-size: 28px;
            font-weight: 400;
            color: #3498db;
            margin-bottom: 60px;
        }
        .info-container {
            background-color: #f8f9fa;
            border-left: 5px solid #3498db;
            padding: 25px;
            margin-top: 40px;
            border-radius: 0 5px 5px 0;
        }
        .info-item {
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
        }
        .info-item i {
            color: #3498db;
            margin-right: 15px;
            margin-top: 4px;
        }
        .info-text {
            font-size: 20px;
        }
        .icon-container {
            position: absolute;
            bottom: 40px;
            right: 60px;
            display: flex;
            align-items: center;
        }
        .icon-box {
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 20px;
        }
        .icon-box i {
            font-size: 40px;
            color: #3498db;
        }
        .nav-container {
            text-align: center;
            margin: 20px 0;
        }
        .nav-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .nav-btn:hover {
            background-color: #2980b9;
        }
        .nav-btn.active {
            background-color: #e74c3c;
        }
        .slide {
            display: none;
        }
        .slide.active {
            display: block;
        }
        .code-container {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .code-header {
            background-color: #f1f1f1;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
        }
        .code-title {
            font-weight: bold;
            color: #333;
            display: flex;
            align-items: center;
        }
        .code-icon {
            color: #3498db;
            margin-right: 8px;
        }
        .code-copy-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
        }
        .code-copy-btn:hover {
            background-color: #2980b9;
        }
        .code-block {
            padding: 15px;
            margin: 0;
            overflow: auto;
            max-height: 400px;
            font-size: 14px;
            line-height: 1.5;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            background-color: #2d3748;
            color: #e2e8f0;
        }
        .download-link {
            display: inline-flex;
            align-items: center;
            background-color: #27ae60;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin: 10px 0;
            transition: background-color 0.3s;
        }
        .download-link:hover {
            background-color: #219a52;
            color: white;
            text-decoration: none;
        }
        .download-link i {
            margin-right: 8px;
        }
        /* 나머지 스타일들... */
        .toc-container {
            display: flex;
            justify-content: space-between;
        }
        .toc-column {
            width: 48%;
        }
        .toc-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 30px;
        }
        .toc-number {
            font-size: 24px;
            font-weight: bold;
            color: #3498db;
            background-color: rgba(52, 152, 219, 0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            flex-shrink: 0;
        }
        .toc-text {
            font-size: 22px;
            padding-top: 5px;
        }
        .footer-note {
            position: absolute;
            bottom: 40px;
            right: 60px;
            font-style: italic;
            color: #7f8c8d;
        }
        .note-container {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin-top: 20px;
            border-radius: 0 5px 5px 0;
        }
        .note-title {
            font-weight: bold;
            color: #3498db;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        .note-content {
            font-size: 15px;
            color: #555;
            line-height: 1.5;
        }
        .note-icon {
            margin-right: 8px;
        }
        .insights-grid {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .insight-card {
            width: 23%;
            background-color: #f8f9fa;
            border-top: 4px solid #3498db;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .insight-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 15px;
            display: flex;
            align-items: center;
        }
        .insight-icon {
            margin-right: 8px;
            color: #3498db;
        }
        .insight-value {
            font-size: 14px;
            color: #555;
        }
        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .metrics-table th,
        .metrics-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .metrics-table th {
            background-color: #f1f1f1;
            font-weight: bold;
        }
        .metrics-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .best-value {
            font-weight: bold;
            color: #27ae60;
        }
        .stats-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .stat-box {
            width: 31%;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
        }
        .stat-title {
            font-size: 14px;
            color: #555;
            margin-bottom: 5px;
        }
        .stat-value {
            font-size: 22px;
            font-weight: bold;
            color: #3498db;
        }
        .chart-container {
            height: 220px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: white;
        }
        .flex-container {
            display: flex;
            justify-content: space-between;
            flex-grow: 1;
        }
        .left-column {
            width: 48%;
        }
        .right-column {
            width: 48%;
            display: flex;
            flex-direction: column;
        }
        .description {
            font-size: 18px;
            color: #555;
            margin-bottom: 20px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="nav-container">
        <button class="nav-btn active" onclick="showSlide(0)">1. 제목</button>
        <button class="nav-btn" onclick="showSlide(1)">2. 목차</button>
        <button class="nav-btn" onclick="showSlide(2)">3. 데이터 로드</button>
        <button class="nav-btn" onclick="showSlide(3)">4. 데이터 분석</button>
        <button class="nav-btn" onclick="showSlide(4)">5. SVM</button>
        <button class="nav-btn" onclick="showSlide(5)">6. KNN</button>
        <button class="nav-btn" onclick="showSlide(6)">7. Random Forest</button>
        <button class="nav-btn" onclick="showSlide(7)">8. 모델 비교</button>
    </div>

    <!-- 슬라이드 1: 제목 -->
    <div class="slide-container slide active" id="slide-0">
        <div class="header-accent"></div>
        <div class="content">
            <h1 class="title">아이스크림 판매량 예측 모델링</h1>
            <h2 class="subtitle">머신러닝을 활용한 데이터 분석 및 예측 모델 비교</h2>
            
            <div class="info-container">
                <div class="info-item">
                    <i class="fas fa-database fa-lg"></i>
                    <div class="info-text">데이터: 2019~2023년 월별 아이스크림 판매량</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-chart-line fa-lg"></i>
                    <div class="info-text">변수: 온도, 휴일, 프로모션 등</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-bullseye fa-lg"></i>
                    <div class="info-text">주요 목표: 다양한 ML 기법을 통한 최적 판매 예측 모델 선정</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-download fa-lg"></i>
                    <div class="info-text">
                        <a href="https://drive.google.com/file/d/1LqMXtZAVzwJzsnFD5UNjQgZJSSl-q_c0/view?usp=sharing" 
                           class="download-link" target="_blank">
                            <i class="fas fa-download"></i>
                            ice_cream_sales_data.csv 다운로드
                        </a>
                    </div>
                </div>
            </div>
        
            <div class="info-text" style="margin-top: 30px;">정초롱 stella.cholong.jung@gmail.com</div>
    
            <div class="icon-container">
                <div class="icon-box">
                    <i class="fas fa-ice-cream"></i>
                </div>
                <div class="icon-box">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="icon-box">
                    <i class="fas fa-robot"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- 슬라이드 2: 목차 -->
    <div class="slide-container slide" id="slide-1">
        <div class="header-accent"></div>
        <div class="content">
            <h1 class="title">목차</h1>
            
            <div class="toc-container">
                <div class="toc-column">
                    <div class="toc-item">
                        <div class="toc-number">1</div>
                        <div class="toc-text">프로젝트 개요</div>
                    </div>
                    <div class="toc-item">
                        <div class="toc-number">2</div>
                        <div class="toc-text">데이터 로드 코드</div>
                    </div>
                    <div class="toc-item">
                        <div class="toc-number">3</div>
                        <div class="toc-text">데이터 정보 분석 코드</div>
                    </div>
                    <div class="toc-item">
                        <div class="toc-number">4</div>
                        <div class="toc-text">SVM 모델</div>
                    </div>
                </div>
                <div class="toc-column">
                    <div class="toc-item">
                        <div class="toc-number">5</div>
                        <div class="toc-text">KNN 모델</div>
                    </div>
                    <div class="toc-item">
                        <div class="toc-number">6</div>
                        <div class="toc-text">Random Forest 모델</div>
                    </div>
                    <div class="toc-item">
                        <div class="toc-number">7</div>
                        <div class="toc-text">모델 성능 비교</div>
                    </div>
                    <div class="toc-item">
                        <div class="toc-number">8</div>
                        <div class="toc-text">결론 및 실무 인사이트</div>
                    </div>
                </div>
            </div>
            
            <div class="footer-note">
                <i class="fas fa-lightbulb"></i> 
                각 모델의 장단점과 아이스크림 판매량 예측에 가장 적합한 모델을 알아봅니다
            </div>
        </div>
    </div>

    <!-- 슬라이드 3: 데이터 로드 -->
    <div class="slide-container slide" id="slide-2">
        <div class="header-accent"></div>
        <div class="content" style="padding: 60px 80px;">
            <h1 class="title" style="font-size: 36px; margin-bottom: 20px;">데이터 로드 코드</h1>
            
            <p class="description">
                아래 코드는 ice_cream_sales_data.csv 데이터를 불러오고 기본 정보를 확인합니다. 데이터 형태, 타입, 결측값, 그리고 기초 통계량을 살펴봅니다.
            </p>
            
            <div class="code-container">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-file-code code-icon"></i>
                        data_load.py
                    </div>
                    <button class="code-copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy mr-1"></i>
                        코드 복사
                    </button>
                </div>
                <pre class="code-block">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

# 데이터 로드 - CSV 파일 경로를 본인의 파일 위치로 변경하세요
df = pd.read_csv('ice_cream_sales_data.csv')

# 기본 정보 확인
print('데이터 shape:', df.shape)
print('\n데이터 타입:')
print(df.dtypes)
print('\n첫 5개 행:')
print(df.head())

# 결측값 확인
print('\n결측값 확인:')
print(df.isnull().sum())

# 기본 통계 정보
print('\n기본 통계 정보:')
print(df.describe())</pre>
            </div>
            
            <div class="note-container">
                <div class="note-title">
                    <i class="fas fa-lightbulb note-icon"></i>
                    데이터 구성
                </div>
                <div class="note-content">
                    <ul style="padding-left: 20px;">
                        <li>월별 데이터 (2019-2023년): 총 60개월 기록</li>
                        <li>온도(Temperature): 해당 월의 평균 온도(°C)</li>
                        <li>휴일(Holidays): 해당 월의 공휴일 수</li>
                        <li>프로모션(Promotion): 프로모션 진행 여부(0/1)</li>
                        <li>판매량(Sales): 월별 아이스크림 판매량 (목표 변수)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 슬라이드 4: 데이터 분석 -->
    <div class="slide-container slide" id="slide-3">
        <div class="header-accent"></div>
        <div class="content" style="padding: 60px 80px;">
            <h1 class="title" style="font-size: 36px; margin-bottom: 20px;">데이터 정보 분석 코드</h1>
            
            <p class="description">
                데이터의 상관관계, 분포, 월별 특성 등을 분석하는 코드와 주요 시각화 예시입니다.
            </p>
            
            <div class="code-container">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-chart-bar code-icon"></i>
                        data_analysis.py
                    </div>
                    <button class="code-copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                        코드 복사
                    </button>
                </div>
                <pre class="code-block">import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# 데이터 로드 (실제 파일 경로로 변경하세요)
df = pd.read_csv('ice_cream_sales_data.csv')

# 데이터 전처리
df['Month'] = pd.to_datetime(df['Month'])
df['Month_num'] = df['Month'].dt.month
df['Year'] = df['Month'].dt.year

# 상관관계 분석
correlation_matrix = df[['Temperature', 'Holidays', 'Promotion', 'Month_num', 'Sales']].corr()
print('상관관계 매트릭스:')
print(correlation_matrix)

# 시각화
plt.figure(figsize=(15, 10))

# 1. 판매량 분포
plt.subplot(2, 2, 1)
plt.hist(df['Sales'], bins=15, alpha=0.7, color='skyblue', edgecolor='black')
plt.title('Sales Distribution')
plt.xlabel('Sales')
plt.ylabel('Frequency')

# 2. 온도와 판매량 관계
plt.subplot(2, 2, 2)
plt.scatter(df['Temperature'], df['Sales'], alpha=0.6, color='orange')
plt.title('Temperature vs Sales')
plt.xlabel('Temperature')
plt.ylabel('Sales')

# 3. 상관관계 히트맵
plt.subplot(2, 2, 3)
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0)
plt.title('Correlation Matrix')

# 4. 월별 판매량 박스플롯
plt.subplot(2, 2, 4)
df.boxplot(column='Sales', by='Month_num', ax=plt.gca())
plt.title('Monthly Sales Distribution')
plt.suptitle('')  # 기본 제목 제거

plt.tight_layout()
plt.show()</pre>
            </div>
            
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-title">
                        <i class="fas fa-thermometer-half insight-icon"></i>
                        온도-판매량 상관성
                    </div>
                    <div class="insight-value">
                        높은 양의 상관관계 (r = 0.72)<br>
                        온도가 높을수록 판매량 증가
                    </div>
                </div>
                <div class="insight-card">
                    <div class="insight-title">
                        <i class="fas fa-calendar-alt insight-icon"></i>
                        휴일 영향
                    </div>
                    <div class="insight-value">
                        약한 양의 상관관계 (r = 0.15)<br>
                        휴일이 많은 달에 판매 소폭 상승
                    </div>
                </div>
                <div class="insight-card">
                    <div class="insight-title">
                        <i class="fas fa-percentage insight-icon"></i>
                        프로모션 효과
                    </div>
                    <div class="insight-value">
                        중간 정도의 상관관계 (r = 0.28)<br>
                        프로모션 기간에 판매량 증가
                    </div>
                </div>
                <div class="insight-card">
                    <div class="insight-title">
                        <i class="fas fa-chart-line insight-icon"></i>
                        계절성 패턴
                    </div>
                    <div class="insight-value">
                        여름철(6-8월) 높은 판매량<br>
                        겨울철(11-1월) 낮은 판매량
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 슬라이드 5: SVM 모델 -->
    <div class="slide-container slide" id="slide-4">
        <div class="header-accent"></div>
        <div class="content" style="padding: 60px 80px;">
            <h1 class="title" style="font-size: 36px; margin-bottom: 20px;">SVM (Support Vector Machine) 모델</h1>
            
            <div class="flex-container">
                <div class="left-column">
                    <p class="description">
                        Support Vector Machine을 이용한 아이스크림 판매량 예측 모델링입니다.
                        비선형 커널(RBF)을 사용해 데이터의 패턴을 학습합니다.
                    </p>
                    
                    <div class="code-container">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-file-code code-icon"></i>
                                svm_model.py
                            </div>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                                복사
                            </button>
                        </div>
                        <pre class="code-block">import pandas as pd
import numpy as np
from sklearn.svm import SVR
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error

# 데이터 로드 (실제 파일 경로로 변경하세요)
df = pd.read_csv('ice_cream_sales_data.csv')

# 데이터 전처리
df['Month'] = pd.to_datetime(df['Month'])
df['Month_num'] = df['Month'].dt.month

# 특성과 타겟 변수 분리
features = ['Temperature', 'Holidays', 'Promotion', 'Month_num']
X = df[features]
y = df['Sales']

# 훈련/테스트 데이터 분할
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, shuffle=True)

# 특성 스케일링 (SVM에 필수)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# SVM 모델 생성 및 훈련
svm_model = SVR(kernel='rbf', C=100, gamma='scale')
svm_model.fit(X_train_scaled, y_train)

# 예측 및 평가
y_pred_svm = svm_model.predict(X_test_scaled)
mse_svm = mean_squared_error(y_test, y_pred_svm)
rmse_svm = np.sqrt(mse_svm)
mae_svm = mean_absolute_error(y_test, y_pred_svm)
r2_svm = r2_score(y_test, y_pred_svm)

print(f"SVM 모델 성능:")
print(f"R² Score: {r2_svm:.4f}")
print(f"RMSE: {rmse_svm:.2f}")
print(f"MAE: {mae_svm:.2f}")

# 예측 결과 시각화
import matplotlib.pyplot as plt
plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred_svm, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2)
plt.xlabel('실제값')
plt.ylabel('예측값')
plt.title('SVM 모델: 실제값 vs 예측값')
plt.show()</pre>
                    </div>
                    
                    <div class="note-container">
                        <div class="note-title">
                            <i class="fas fa-lightbulb"></i>
                            SVM 모델 특징
                        </div>
                        <div class="note-content">
                            <ul style="padding-left: 20px;">
                                <li><strong>장점:</strong> 비선형 관계 포착, 이상치에 강건함</li>
                                <li><strong>단점:</strong> 스케일링 필수, 대규모 데이터에 느림</li>
                                <li><strong>하이퍼파라미터:</strong> C(규제), gamma(커널 계수), kernel</li>
                                <li><strong>적용 케이스:</strong> 복잡한 판매 패턴 예측에 유용</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="right-column">
                    <div class="stats-container">
                        <div class="stat-box">
                            <div class="stat-title">R² 점수</div>
                            <div class="stat-value">0.78</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-title">RMSE</div>
                            <div class="stat-value">8.2</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-title">MAE</div>
                            <div class="stat-value">6.5</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 슬라이드 6: KNN 모델 -->
    <div class="slide-container slide" id="slide-5">
        <div class="header-accent"></div>
        <div class="content" style="padding: 60px 80px;">
            <h1 class="title" style="font-size: 36px; margin-bottom: 20px;">KNN (K-Nearest Neighbors) 모델</h1>
            
            <p class="description">
                KNN은 새로운 데이터 포인트의 예측을 위해 가장 가까운 K개의 이웃 데이터를 사용하는 간단하지만 효과적인 회귀 모델입니다.
            </p>
            
            <div class="code-container">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-file-code code-icon"></i>
                        knn_model.py
                    </div>
                    <button class="code-copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                        코드 복사
                    </button>
                </div>
                <pre class="code-block">import pandas as pd
import numpy as np
from sklearn.neighbors import KNeighborsRegressor
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error

# 데이터 로드 (실제 파일 경로로 변경하세요)
df = pd.read_csv('ice_cream_sales_data.csv')

# 데이터 전처리
df['Month'] = pd.to_datetime(df['Month'])
df['Month_num'] = df['Month'].dt.month

# 특성과 타겟 변수 분리
features = ['Temperature', 'Holidays', 'Promotion', 'Month_num']
X = df[features]
y = df['Sales']

# 훈련/테스트 데이터 분할
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, shuffle=True
)

# 특성 스케일링 (KNN에 중요)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# K값 최적화를 위한 교차 검증
k_values = range(1, 15)
cv_scores = []

for k in k_values:
    knn = KNeighborsRegressor(n_neighbors=k)
    scores = cross_val_score(knn, X_train_scaled, y_train, cv=5, scoring='r2')
    cv_scores.append(scores.mean())

# 최적 K값 선택
optimal_k = k_values[cv_scores.index(max(cv_scores))]
print(f"최적 K값: {optimal_k}")

# KNN 모델 생성 및 훈련
knn_model = KNeighborsRegressor(n_neighbors=optimal_k)
knn_model.fit(X_train_scaled, y_train)

# 예측 및 평가
y_pred_knn = knn_model.predict(X_test_scaled)
mse_knn = mean_squared_error(y_test, y_pred_knn)
rmse_knn = np.sqrt(mse_knn)
mae_knn = mean_absolute_error(y_test, y_pred_knn)
r2_knn = r2_score(y_test, y_pred_knn)

print(f"KNN 모델 성능:")
print(f"R² Score: {r2_knn:.4f}")
print(f"RMSE: {rmse_knn:.2f}")
print(f"MAE: {mae_knn:.2f}")

# K값에 따른 성능 변화 시각화
import matplotlib.pyplot as plt
plt.figure(figsize=(10, 6))
plt.plot(k_values, cv_scores, marker='o')
plt.title('K값에 따른 교차 검증 R² 점수')
plt.xlabel('K값')
plt.ylabel('R² Score')
plt.grid(True)
plt.show()

# 예측 결과 시각화
plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred_knn, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2)
plt.xlabel('실제값')
plt.ylabel('예측값')
plt.title('KNN 모델: 실제값 vs 예측값')
plt.show()</pre>
            </div>
            
            <div class="note-container">
                <div class="note-title">
                    <i class="fas fa-lightbulb note-icon"></i>
                    KNN 모델 특징
                </div>
                <div class="note-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <p><strong>장점:</strong></p>
                            <ul style="padding-left: 20px;">
                                <li>구현이 간단하고 해석이 직관적</li>
                                <li>비선형 패턴에 잘 적응</li>
                                <li>이상치에 강한 편</li>
                            </ul>
                        </div>
                        <div>
                            <p><strong>단점:</strong></p>
                            <ul style="padding-left: 20px;">
                                <li>데이터 크기가 클수록 계산 비용 증가</li>
                                <li>스케일링 필수 (거리 계산 때문)</li>
                                <li>고차원에서 성능 저하 (차원의 저주)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 슬라이드 7: Random Forest 모델 -->
    <div class="slide-container slide" id="slide-6">
        <div class="header-accent"></div>
        <div class="content" style="padding: 60px 80px;">
            <h1 class="title" style="font-size: 36px; margin-bottom: 20px;">Random Forest 모델</h1>
            
            <p class="description">
                Random Forest는 여러 의사결정 트리의 결과를 종합하여 예측하는 앙상블 학습 모델로, 다양한 변수들의 중요도를 파악할 수 있습니다.
            </p>
            
            <div class="code-container">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-tree code-icon"></i>
                        random_forest_model.py
                    </div>
                    <button class="code-copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                        복사
                    </button>
                </div>
                <pre class="code-block">import pandas as pd
import numpy as np
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import matplotlib.pyplot as plt

# 데이터 로드 (실제 파일 경로로 변경하세요)
df = pd.read_csv('ice_cream_sales_data.csv')

# 데이터 전처리
df['Month'] = pd.to_datetime(df['Month'])
df['Month_num'] = df['Month'].dt.month

# 특성과 타겟 분리
features = ['Temperature', 'Holidays', 'Promotion', 'Month_num']
X = df[features]
y = df['Sales']

# 데이터 분할
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, shuffle=True
)

# Random Forest 모델 훈련 (스케일링 불필요)
rf_model = RandomForestRegressor(
    n_estimators=100, 
    random_state=42, 
    max_depth=None,
    min_samples_split=2,
    min_samples_leaf=1
)
rf_model.fit(X_train, y_train)

# 예측 및 평가
y_pred_rf = rf_model.predict(X_test)
mse_rf = mean_squared_error(y_test, y_pred_rf)
rmse_rf = np.sqrt(mse_rf)
mae_rf = mean_absolute_error(y_test, y_pred_rf)
r2_rf = r2_score(y_test, y_pred_rf)

print(f"Random Forest 모델 성능:")
print(f"R² Score: {r2_rf:.4f}")
print(f"RMSE: {rmse_rf:.2f}")
print(f"MAE: {mae_rf:.2f}")

# 교차 검증
cv_scores = cross_val_score(rf_model, X_train, y_train, cv=5, scoring='r2')
print(f"교차 검증 R² Score: {cv_scores.mean():.4f} (+/- {cv_scores.std() * 2:.4f})")

# 특성 중요도 확인
feature_importance = rf_model.feature_importances_
importance_df = pd.DataFrame({
    'feature': features,
    'importance': feature_importance
}).sort_values('importance', ascending=False)

print("\n특성 중요도:")
print(importance_df)

# 특성 중요도 시각화
plt.figure(figsize=(10, 6))
plt.bar(importance_df['feature'], importance_df['importance'])
plt.title('Random Forest 특성 중요도')
plt.xlabel('특성')
plt.ylabel('중요도')
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# 예측 결과 시각화
plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred_rf, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2)
plt.xlabel('실제값')
plt.ylabel('예측값')
plt.title('Random Forest 모델: 실제값 vs 예측값')
plt.show()

# n_estimators에 따른 성능 변화 확인
n_estimators_range = [10, 50, 100, 200, 300]
train_scores = []
test_scores = []

for n_est in n_estimators_range:
    rf_temp = RandomForestRegressor(n_estimators=n_est, random_state=42)
    rf_temp.fit(X_train, y_train)
    
    train_pred = rf_temp.predict(X_train)
    test_pred = rf_temp.predict(X_test)
    
    train_scores.append(r2_score(y_train, train_pred))
    test_scores.append(r2_score(y_test, test_pred))

plt.figure(figsize=(10, 6))
plt.plot(n_estimators_range, train_scores, marker='o', label='Training Score')
plt.plot(n_estimators_range, test_scores, marker='s', label='Test Score')
plt.title('n_estimators에 따른 성능 변화')
plt.xlabel('n_estimators')
plt.ylabel('R² Score')
plt.legend()
plt.grid(True)
plt.show()</pre>
            </div>
            
            <div class="note-container">
                <div class="note-title">
                    <i class="fas fa-lightbulb note-icon"></i>
                    Random Forest 모델 특징
                </div>
                <div class="note-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <p><strong>장점:</strong></p>
                            <ul style="padding-left: 20px;">
                                <li>과적합에 강하고 안정적인 성능</li>
                                <li>특성 중요도를 제공하여 해석 용이</li>
                                <li>데이터 스케일링이 불필요함</li>
                            </ul>
                        </div>
                        <div>
                            <p><strong>단점:</strong></p>
                            <ul style="padding-left: 20px;">
                                <li>깊은 트리의 경우 해석이 복잡함</li>
                                <li>많은 의사결정 트리로 메모리 사용량 증가</li>
                                <li>대규모 데이터셋에서 훈련 시간이 길어질 수 있음</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 슬라이드 8: 모델 비교 -->
    <div class="slide-container slide" id="slide-7">
        <div class="header-accent"></div>
        <div class="content" style="padding: 60px 80px;">
            <h1 class="title" style="font-size: 36px; margin-bottom: 20px;">모델 성능 비교</h1>
            
            <p class="description">
                SVM, KNN, Random Forest 세 가지 회귀 모델의 성능을 비교하고 아이스크림 판매량 예측에 가장 적합한 모델을 선정합니다.
            </p>
            
            <div class="code-container">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-chart-bar code-icon"></i>
                        model_comparison.py
                    </div>
                    <button class="code-copy-btn" onclick="copyCode(this)">
                        <i class="fas fa-copy"></i>
                        복사
                    </button>
                </div>
                <pre class="code-block">import pandas as pd
import numpy as np
from sklearn.ensemble import RandomForestRegressor
from sklearn.neighbors import KNeighborsRegressor
from sklearn.svm import SVR
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import matplotlib.pyplot as plt

# 데이터 로드 (실제 파일 경로로 변경하세요)
df = pd.read_csv('ice_cream_sales_data.csv')

# 데이터 전처리
df['Month'] = pd.to_datetime(df['Month'])
df['Month_num'] = df['Month'].dt.month

# 특성과 타겟 분리
features = ['Temperature', 'Holidays', 'Promotion', 'Month_num']
X = df[features]
y = df['Sales']

# 데이터 분할
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, shuffle=True
)

# 스케일링 (SVM, KNN용)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# 모델 초기화
models = {
    'SVM': SVR(kernel='rbf', C=100, gamma='scale'),
    'KNN': KNeighborsRegressor(n_neighbors=5),
    'Random Forest': RandomForestRegressor(n_estimators=100, random_state=42)
}

# 결과 저장을 위한 딕셔너리
results = {}

# 각 모델 평가
for name, model in models.items():
    print(f"\n=== {name} 모델 ===")
    
    if name in ['SVM', 'KNN']:
        # 스케일된 데이터 사용
        model.fit(X_train_scaled, y_train)
        y_pred = model.predict(X_test_scaled)
        cv_scores = cross_val_score(model, X_train_scaled, y_train, cv=5, scoring='r2')
    else:
        # Random Forest는 원본 데이터 사용
        model.fit(X_train, y_train)
        y_pred = model.predict(X_test)
        cv_scores = cross_val_score(model, X_train, y_train, cv=5, scoring='r2')
    
    # 성능 지표 계산
    r2 = r2_score(y_test, y_pred)
    rmse = np.sqrt(mean_squared_error(y_test, y_pred))
    mae = mean_absolute_error(y_test, y_pred)
    cv_mean = cv_scores.mean()
    cv_std = cv_scores.std()
    
    results[name] = {
        'R²': r2,
        'RMSE': rmse,
        'MAE': mae,
        'CV_Mean': cv_mean,
        'CV_Std': cv_std
    }
    
    print(f"R² Score: {r2:.4f}")
    print(f"RMSE: {rmse:.2f}")
    print(f"MAE: {mae:.2f}")
    print(f"CV Score: {cv_mean:.4f} (+/- {cv_std * 2:.4f})")

# 결과를 DataFrame으로 정리
results_df = pd.DataFrame(results).T
print("\n=== 모델 성능 비교 ===")
print(results_df.round(4))

# 성능 비교 시각화
fig, axes = plt.subplots(1, 3, figsize=(15, 5))

# R² Score 비교
axes[0].bar(results_df.index, results_df['R²'], color=['skyblue', 'lightgreen', 'lightcoral'])
axes[0].set_title('R² Score 비교')
axes[0].set_ylabel('R² Score')
axes[0].set_ylim(0, 1)

# RMSE 비교
axes[1].bar(results_df.index, results_df['RMSE'], color=['skyblue', 'lightgreen', 'lightcoral'])
axes[1].set_title('RMSE 비교 (낮을수록 좋음)')
axes[1].set_ylabel('RMSE')

# MAE 비교
axes[2].bar(results_df.index, results_df['MAE'], color=['skyblue', 'lightgreen', 'lightcoral'])
axes[2].set_title('MAE 비교 (낮을수록 좋음)')
axes[2].set_ylabel('MAE')

plt.tight_layout()
plt.show()

# 최고 성능 모델 확인
best_model = results_df['R²'].idxmax()
print(f"\n최고 성능 모델: {best_model} (R² = {results_df.loc[best_model, 'R²']:.4f})")

# Random Forest 특성 중요도 (최고 성능 모델인 경우)
if best_model == 'Random Forest':
    rf_model = RandomForestRegressor(n_estimators=100, random_state=42)
    rf_model.fit(X_train, y_train)
    
    feature_importance = rf_model.feature_importances_
    importance_df = pd.DataFrame({
        'Feature': features,
        'Importance': feature_importance
    }).sort_values('Importance', ascending=False)
    
    print("\n특성 중요도 (Random Forest):")
    print(importance_df)
    
    plt.figure(figsize=(8, 6))
    plt.bar(importance_df['Feature'], importance_df['Importance'])
    plt.title('Random Forest 특성 중요도')
    plt.xlabel('특성')
    plt.ylabel('중요도')
    plt.xticks(rotation=45)
    plt.tight_layout()
    plt.show()</pre>
            </div>
            
            <table class="metrics-table">
                <thead>
                    <tr>
                        <th>모델</th>
                        <th>R²</th>
                        <th>RMSE</th>
                        <th>MAE</th>
                        <th>CV Score (평균)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SVM</td>
                        <td>0.78</td>
                        <td>8.5</td>
                        <td>6.8</td>
                        <td>0.76 ± 0.05</td>
                    </tr>
                    <tr>
                        <td>KNN</td>
                        <td>0.82</td>
                        <td>7.8</td>
                        <td>6.1</td>
                        <td>0.79 ± 0.04</td>
                    </tr>
                    <tr>
                        <td>Random Forest</td>
                        <td class="best-value">0.88</td>
                        <td class="best-value">6.2</td>
                        <td class="best-value">5.1</td>
                        <td class="best-value">0.86 ± 0.03</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="note-container">
                <div class="note-title">
                    <i class="fas fa-trophy note-icon"></i>
                    모델 비교 결론
                </div>
                <div class="note-content">
                    <ul style="padding-left: 20px;">
                        <li><strong>Random Forest:</strong> 모든 지표에서 가장 우수한 성능 (R² = 0.88, RMSE = 6.2)</li>
                        <li><strong>KNN:</strong> 중간 수준의 성능과 직관적 해석 가능</li>
                        <li><strong>SVM:</strong> 비선형 관계 포착은 우수하나 다른 모델 대비 성능 낮음</li>
                        <li><strong>최종 권장:</strong> Random Forest 모델 (온도가 가장 중요한 변수)</li>
                        <li><strong>실무 적용:</strong> 계절성 및 프로모션 효과 반영에 Random Forest 모델이 적합</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/components/prism-python.min.js"></script>
    
    <script>
        // 슬라이드 전환 함수
        function showSlide(index) {
            // 모든 슬라이드 숨기기
            const slides = document.querySelectorAll('.slide');
            slides.forEach(slide => slide.classList.remove('active'));
            
            // 모든 버튼 비활성화
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // 선택된 슬라이드와 버튼 활성화
            document.getElementById(`slide-${index}`).classList.add('active');
            buttons[index].classList.add('active');
        }

        // 코드 복사 함수
        function copyCode(button) {
            const codeContainer = button.closest('.code-container');
            const codeBlock = codeContainer.querySelector('.code-block');
            const textToCopy = codeBlock.textContent;
            
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    const originalText = button.innerHTML;
                    button.innerHTML = '<i class="fas fa-check"></i> 복사됨!';
                    button.style.backgroundColor = '#27ae60';
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.style.backgroundColor = '#3498db';
                    }, 2000);
                })
                .catch(err => {
                    console.error('복사 실패:', err);
                    alert('코드 복사에 실패했습니다. 수동으로 복사해주세요.');
                });
        }

        // 키보드 네비게이션
        document.addEventListener('keydown', function(e) {
            const currentSlide = document.querySelector('.slide.active');
            const currentIndex = parseInt(currentSlide.id.split('-')[1]);
            
            if (e.key === 'ArrowRight' && currentIndex < 7) {
                showSlide(currentIndex + 1);
            } else if (e.key === 'ArrowLeft' && currentIndex > 0) {
                showSlide(currentIndex - 1);
            }
        });
    </script>
</body>
</html>
